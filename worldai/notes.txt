Plans
-----

- Add user approval to some tool functions

- Probably need to reset thread in design client on world changes

- Convert from IDs to names for the AI func calls
- Add history of conversations and use in RAG calls
- Add world knowledege and facts - use RAG
- Add per character knowledge, use RAG
- find character and items?

- Features:
  -unlock site. design attribute for locked sites, - DONE
  - player died
  - slow poison,  capture, brainwash
  - character status in character list

- Refactor design vs instance interfaces.
- Variable number of items per type

- Important character attributes:
  - what do they want? what is important? what do they need?
  - will make deals - what type of deals

- More interesting features?
- Add win criteria: character y is at x, has x. character has x, is at x.

- Use templates to drive design creation?

- Add topology?
- Walk from site to site connected
- Site with subsites? - areas?



- Basic world design - DONE
- Basic character interaction - DONE
- Add character tags - DONE
- Add item properties and use item - DONE
- Time keeping - DONE


Bugs
----

- modes too restrictive? AI wants to call CreateWorld, not there
- ShowWorld - 
- removing and restoring elements only works if the mode is correct
- removing an element may not refresh the list of elements in the
  message thread


TODO
----
- Make chat interaction use Pydantic - DONE
- support chat in response to actions - DONE
- tool choice in character chat 
- complete API test coverage - DONE, but missing cases
  - check if mock test env is reusable for all
- client command test coverage - DONE
- standard character / player data store
- serialize threads in JSON, not pickle



Details
-------
- a task / TODO generator
  - number of characters, items, sites
  - complete characters, items, sites
- Revamp ChatExchange API messages
- trim contents of message history in chat_session
- handle DB errors
- protect APIs against bad id args
- consider changing state to mode
- set budget for tokens and images (images done)
- update status of calls in client


Completed
---------
- added ability to remove (hide) images, items, characters, and sites
- fix refresh and chat enable on character move - done
- list of characters at the same location - done?
- Persist player location - done
- consider items at sites, not with a character? - done
- consider allowing characters to
  - change location - done
  - teach skills
  - give / take coin
- React client does not yet support markdown - done
- React design client - done
- fix personality description string - goofing up system message - done

Working notes
---------
import json
# pip install pyyaml
import yaml


f = open("worldai/openapi.yml")
s = yaml.safe_load(f)
print(json.dumps(s, indent=4))
